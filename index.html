<script>
    async function loadTaskContentFromSpreadsheet() {
        try {
            const response = await fetch('https://docs.google.com/spreadsheets/d/e/2PACX-1vRp3F2DxIC6QMR-HlhW-lM_mrCHYoBGkgI8_hNlhahGQQUnRQzgI-Bs_epi81RBUy8TE78Q6JRbIepg/pubhtml?gid=0&single=true');

            if (!response.ok) {
                throw new Error(`Erro ao acessar a URL: ${response.statusText}`);
            }

            const text = await response.text();

            const parser = new DOMParser();
            const doc = parser.parseFromString(text, 'text/html');
            const table = doc.querySelector('table');

            if (table) {
                const colgroup = `<colgroup>
                                  <col class="largura-grupo1">
                                  <col class="largura-grupo1">
                                  <col class="largura-grupo1">
                                  <col class="largura-grupo1">
                                  <col class="largura-grupo2">
                                  <col class="largura-grupo2">
                              </colgroup>`;
                table.insertAdjacentHTML('afterbegin', colgroup);

                const rows = table.querySelectorAll('tr');
                rows.forEach((row, rowIndex) => {
                    const cells = row.querySelectorAll('td, th');

                    if (rowIndex === 0) {
                        // Títulos da tabela, sem alterações
                        return;
                    }

                    // Substituir conteúdo da célula "Video Suport" pela imagem clicável
                    const videoCell = cells[cells.length - 1]; // Supondo que a última coluna seja "Video Suport"
                    const videoLink = videoCell.innerText.trim(); // Link para o vídeo
                    if (videoLink) {
                        videoCell.innerHTML = `
                            <a href="${videoLink}" target="_blank">
                                <img src="youtube.png" alt="YouTube Video" style="width: 50px; height: auto;">
                            </a>`;
                    }

                    // Remove a primeira célula se necessário
                    if (cells.length > 0) {
                        cells[0].remove();
                    }

                    // Remove linhas vazias
                    if (!row.innerText.trim()) {
                        row.remove();
                    }
                });

                const firstDataRow = table.querySelector('tbody tr');
                if (firstDataRow) {
                    firstDataRow.style.backgroundColor = '#320002';
                    firstDataRow.style.color = 'white';
                    firstDataRow.style.fontWeight = 'bold';
                }

                document.getElementById('content').innerHTML = `<h2></h2>${table.outerHTML}`;
            } else {
                document.getElementById('content').innerHTML = '<p>Erro ao carregar a tabela da planilha.</p>';
            }
        } catch (error) {
            console.error('Erro ao carregar a planilha:', error);
            document.getElementById('content').innerHTML = '<p>Erro ao carregar a Guia Task.</p>';
        }
    }
</script>
